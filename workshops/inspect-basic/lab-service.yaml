ingress:
  enabled: true
  ingressClassName: "cilium"
  hosts:
    - "inspect-basic.local"
rbac:
  create: true
hub:
  readinessProbe:
    initialDelaySeconds: 15
  extraConfig: 
    jupyterServerProxyConfig.py: |
        import shlex
        c.ServerProxy.servers = {
          'vscode': {
            'command': [
              'code-server',
              '--bind-addr=0.0.0.0:8888',
              '--auth=none',
              '--base-path={base_url_path}vscode/',
              '/home/coder/workspace'
            ],
            'absolute_url': True,
            'new_browser_tab': False,
            'launcher_entry': {
              'title': 'VS Code'
            }
          }
        }
singleuser:
  # 1. Point to your new image that contains code-server
  image:
    name: "ghcr.io/nbhdai/workshop-inspect-basic"
    tag: "tilt-hub-workshop"
  defaultUrl: "/"
  # I'm pretty sure this is blocked by cilium and this violates a security policy talos configures.
  cloudMetadata:
    blockWithIptables: false
  cmd: ["jupyterhub-singleuser"]
  extraEnv:
    PYTHONUNBUFFERED: "1"
    GRPC_VERBOSITY: "INFO"
    OPENAI_API_KEY: "hidden"
    OPENAI_BASE_URL: "ai-proxy/openai/"
    GOOGLE_API_KEY: "hidden"
    GOOGLE_BASE_URL: "ai-proxy/gemini/"
    ANTHROPIC_API_KEY: "hidden"
    ANTHROPIC_BASE_URL: "ai-proxy/anthropic/"
  storage:
    capacity: 1Gi
    
cull:
  enabled: true
  timeout: 3600 # 1 hour
  every: 300
